<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Расчёт рабочих дней</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    input, button { margin: 5px 0; font-size: 16px; padding: 5px; }
    button { cursor: pointer; }
  </style>
</head>
<body>
  <h2>Расчёт рабочих дней</h2>
  <label>Дата начала: <input type="date" id="start"></label><br>
  <label>Дата окончания: <input type="date" id="end"></label><br>
  <button id="calc">Рассчитать</button>

  <h3 id="result"></h3>

  <script>
    document.getElementById('calc').onclick = async () => {
      const start = new Date(document.getElementById('start').value);
      const end = new Date(document.getElementById('end').value);
      if (!start || !end || end < start) {
        alert('Проверь даты');
        return;
      }

      // Календарь праздников России (официальный Google Calendar)
      const calendarId = 'ru.russian#holiday@group.v.calendar.google.com';
      const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?key=AIzaSyDGJK2LqOP8dgBBRztcSUH0joctDj0DqZk&timeMin=${start.toISOString()}&timeMax=${end.toISOString()}`;

      const response = await fetch(url);
      const data = await response.json();
      const holidays = data.items.map(e => new Date(e.start.date).toDateString());

      let count = 0;
      for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
        const day = d.getDay(); // 0=вс,6=сб
        if (day === 0 || day === 6) continue;
        if (holidays.includes(d.toDateString())) continue;
        count++;
      }

      document.getElementById('result').innerText = `Рабочих дней: ${count}`;
    };
  </script>
</body>
</html>
